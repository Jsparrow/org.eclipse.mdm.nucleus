<!-- *******************************************************************************
  * Copyright (c) 2016 Gigatronik Ingolstadt GmbH
  * All rights reserved. This program and the accompanying materials
  * are made available under the terms of the Eclipse Public License v1.0
  * which accompanies this distribution, and is available at
  * http://www.eclipse.org/legal/epl-v10.html
  *
  * Contributors:
  * Dennis Schroeder - initial implementation
  ******************************************************************************* -->
  <div class="container-fluid">
    <div class="row">
      <div class="col-lg-12">
        <div class="form-group">
          <form class="form-inline">
	          <label for="search-source" class="control-label">Filter</label>
	          <div class="btn-group" dropdown>
	            <button id="search-source" type="button" class="btn btn-default dropdown-toggle" dropdownToggle [disabled]="disabled" aria-haspopup="true" aria-expanded="false">
	              {{selectedFilter.name}} <span class="caret"></span>
	            </button>
	            <ul class="dropdown-menu" dropdownMenu>
                <li *ngFor="let filter of filters">
                  <a class="dropdown-item" (click)="selectFilter(filter)">{{filter.name}}</a>
                </li>
	            </ul>
	          </div>
	          <label for="search-source" class="control-label">Quelle</label>
	          <div class="btn-group" dropdown>
	            <button id="search-source" type="button" class="btn btn-default dropdown-toggle" dropdownToggle [disabled]="disabled" aria-haspopup="true" aria-expanded="false">
	            {{selectedEnv[0]?.name}} <span class="caret"></span>
	            </button>
	            <ul class="dropdown-menu" dropdownMenu>
                <li *ngFor="let env of envs">
                  <a class="dropdown-item" (click)="selectEnv(env)">{{env.name}}</a>
                </li>
	            </ul>
	          </div>
	          <label for="search-resulttype" class="control-label">Ergebnistyp</label>
	          <div class="btn-group" dropdown>
	            <button id="search-resulttype" type="button" class="btn btn-default dropdown-toggle" dropdownToggle [disabled]="disabled" aria-haspopup="true" aria-expanded="false">
	            {{type.label}} <span class="caret"></span>
	            </button>
	            <ul class="dropdown-menu" dropdownMenu>
                <li *ngFor="let opt of definitions.options" role="menuitem">
                  <a class="dropdown-item" (click)="selectDef(opt)">{{opt.label}}</a>
                </li>
	            </ul>
	          </div>
	          <div class="input-group">
    			<input type="text" class="form-control" placeholder="Suchtext eingeben" #query (keyup.enter)="onSubmit(query.value)" aria-describedby="basic-addon1">
  			  	<div class="input-group-btn">
	              <button type="button" class="btn btn-default" (click)="onSubmit(query.value)">Suchen</button>
	            </div>
	          </div>
	       </form>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-12">
        <accordion>
           <accordion-group [isOpen]="isAdvancedSearchOpen" #advancedSearch>
             <div accordion-heading>
               Advanced search
               <i class="pull-right glyphicon"[ngClass]="{'glyphicon-chevron-down': advancedSearch?.isOpen, 'glyphicon-chevron-right': !advancedSearch?.isOpen}"></i>
             </div>
             <div>
               <form class="form-inline">
                 <button id="filter-new" type="button" class="btn btn-default">New Filter ...</button>
                 <button id="filter-add" type="button" class="btn btn-default">Add ...</button>
                 <button id="filter-save" type="button" class="btn btn-default pull-right" >Save ...</button>
                 <button id="filter-reset" type="button" class="btn btn-default pull-right" (onClick)="resetFilter()">Reset</button>
               </form>
               <div *ngFor="let env of selectedFilter.envs">
                 <div *ngIf="env.conditions.length > 0">
                   <h3>{{env.name}}</h3>
                   <table class="table table-bordered searchdefinition">
                    <colgroup>
                      <col style="width:15%">
                      <col style="width:15%">
                      <col style="width:10%">
                      <col style="width:50%">
                      <col style="width:5%">
                      <col style="width:5%">
                    </colgroup>
                     <tr *ngFor="let condition of env.conditions">
                       <td>{{condition.type}}</td>
                       <td>{{condition.attribute}}</td>
                       <td>
                         <div class="btn-group" dropdown>
                           <button id="operator" type="button" class="btn btn-default dropdown-toggle" dropdownToggle [disabled]="disabled" aria-haspopup="true" aria-expanded="false">
                             {{getOperatorName(condition.operator)}} <span class="caret"></span>
                           </button>
                           <ul class="dropdown-menu" dropdownMenu>
                             <li *ngFor="let op of getOperators()">
                               <a class="dropdown-item" (click)="selectConditionOperator(condition, op)">{{getOperatorName(op)}}</a>
                             </li>
                           </ul>
                         </div>
                       </td>
                       <td><input type="text" class="form-control" placeholder="Wert" value="{{condition.value}}"></td>
                       <td><button id="add" type="button" class="btn btn-default">+</button></td>
                       <td><button id="remove" type="button" class="btn btn-default" (click)="removeCondition(env, condition)">-</button></td>
                     </tr>
                   </table>
                 </div>
               </div>
             </div>
           </accordion-group>
           <accordion-group [isOpen]="isSearchResultsOpen" #searchResults>
             <div accordion-heading>
               Ergebnisse
               <i class="pull-right glyphicon"[ngClass]="{'glyphicon-chevron-down': searchResults?.isOpen, 'glyphicon-chevron-right': !searchResults?.isOpen}"></i>
             </div>
             <mdm-tableview [nodes]="nodes" isShopable="true"></mdm-tableview>
           </accordion-group>
        </accordion>
      </div>
    </div>
  </div>
